apiVersion: v1beta2
kind: LocalPolicy
metadata:
  name: default-policy
policies:
  default:
    # デフォルトポリシー設定
    # 初期は detect-learn モードで動作確認後、prevent-learn に移行
    mode: detect-learn
    
    # カスタムレスポンス（ブロック時のHTTPステータスコード）
    customResponse: 403
    
    # デフォルトのセキュリティプラクティス
    # 基本的なWAF保護を有効化（学習モード）
    # 注意: 実際のプラクティス定義は別途必要ですが、最小構成では空でも動作します
    threatPreventionPractices: []
    accessControlPractices: []
    triggers: []
    sourceIdentifiers: {}
    trustedSources: []
    exceptions: []

  # FQDN別の設定（specificRules）
  # 設定取得エージェントが自動生成するため、初期は空
  # 例:
  # - host: "test.example.com"
  #   mode: detect-learn
  #   threatPreventionPractices: []
  #   accessControlPractices: []
  specificRules: []
